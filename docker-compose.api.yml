version: "3.9"
services:
  domino74-api:
    build: ./server
    restart: unless-stopped
    environment:
      DATABASE_URL: ${DATABASE_URL}
      API_KEY: ${API_KEY}
      PORT: ${API_PORT:-4000}
      HOST: 0.0.0.0
      DEFAULT_TZ: ${DEFAULT_TZ:-America/Merida}
      ENABLE_CORS: ${ENABLE_CORS:-1}
      PG_POOL_MAX: ${PG_POOL_MAX:-10}
      PGSSL: ${PGSSL:-0}
      UPLOADS_DIR: ${UPLOADS_DIR:-/app/uploads}
      UPLOADS_BASE_PATH: ${UPLOADS_BASE_PATH:-/uploads}
      UPLOADS_PUBLIC_BASE_URL: ${UPLOADS_PUBLIC_BASE_URL:-}
      UPLOAD_MAX_BYTES: ${UPLOAD_MAX_BYTES:-52428800}
    ports:
      - "${API_PORT:-4000}:4000"
    extra_hosts:
      - "db:185.211.4.129"
    volumes:
      - uploads_data:/app/uploads
    networks:
      - domino_net
networks:
  domino_net:
    external: false
volumes:
  uploads_data:
